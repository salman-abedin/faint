#!/bin/sh
#
# Config file for faint
#
# Dependencies: file

#===============================================================================
#                 Bindings ( ⁉ has to be a single character!)
#===============================================================================

KEY_LAUNCH=";"
KEY_BACK=","
KEY_OPERATE="space"
KEY_QUIT="esc"
KEY_SHELL="enter"

#===============================================================================
#                             Filters
#===============================================================================

FILTERS="\
node_modules;
package-lock.json;
yarn.lock;
.git;
"

#===============================================================================
#                             Operations
#===============================================================================

# Variable Conventions
#     FILE_ARGS      = Files selected for operation ( ⁉ Has to be unquoted )
#     FILE_LIST      = Files tracked for consecutive operations
#     FILE_LIST_PATH = PATH for tracking files

#---------------------------------------
# Operation Functions
#---------------------------------------
delete() { rm -fr $FILE_ARGS; }
trash() { rsync -a $FILE_ARGS "$TRASH" && delete; }
yank() { echo $FILE_ARGS | xsel -b && echo $FILE_ARGS > "$FILE_LIST_PATH"; }
paste() { rsync -a $FILE_LIST "$LAST_DIR"; }
duplicate() { rsync -a $FILE_ARGS $FILE_ARGS~; }
move() { mv $FILE_LIST "$LAST_DIR"; }
link_soft() { cp -frus $FILE_LIST "$LAST_DIR"; }
link_hard() { cp -frul $FILE_LIST "$LAST_DIR"; }

#---------------------------------------
# <OPERATION_NAME>:<OPERATION_FUNCTION>
#---------------------------------------
OPS="\
❌ Delete:delete;
⚔ Trash:trash;
© Yank:yank;
🖌 Paste:paste;
🚚 Move:move;
‼ Duplicate:duplicate;
🗞 Soft Link:link_soft;
🌴 Hard Link:link_hard;
"

#===============================================================================
#                             Launching
#===============================================================================

#---------------------------------------
#              Launch Functions
#---------------------------------------

launch_media() {
   ns "$1"
}

#---------------------------------------
# <MIME_TYPE>:<Launch Functions>
#---------------------------------------
MIMES="\
video/mp4:launch_media;
"

_get_mimes() {
   CURRENT_IFS=$IFS
   IFS=$(printf ';')
   for line in $MIMES; do
      case $line in
         *"$1"*) TEMP=${line%;*} && echo "${TEMP#*:}" && break ;;
      esac
   done
   IFS=$CURRENT_IFS
}

faint_launch() {
   ARG_MIME=$(file --mime-type "$1" -bL)
   CMD=$(_get_mimes "$ARG_MIME")
   "$CMD" "$1" 2> /dev/null
}

#===============================================================================
#                               Icons
#===============================================================================

#---------------------------------------
# <EXTENSION1|EXTENSION2|...>:<ICON>
#---------------------------------------
ICONS="\
dir:📁;
file:📃;
iso|img:📀;
png|ico:🖼;
jpg|jpeg:📸;
part:💔;
json:📒;
md:📘;
tex:📜;
css|sass|scss:🎨;
html|pug:🌎;
pdf|epub: 📚;
mp4|mkv:🎥;
"
